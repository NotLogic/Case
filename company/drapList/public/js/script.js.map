{"version":3,"sources":["script.js"],"names":["byId","id","document","getElementById","loadScripts","desc","callback","deps","key","idx","push","_next","pid","name","script","createElement","type","src","setInterval","window","clearTimeout","apply","getElementsByTagName","appendChild","console","log","alert","join","arguments","Sortable","create","group","animation","onEnd","evt","statistics","DrapList","drapListElement","$","drapListElementLen","length","setDraplist","drap","len","draplist","each","element","children","toggleDrapFullMessage","append","last","obj","val","time","text","fadeIn","setTimeout","fadeOut","sortingCheckedSum","el","arr","is","sortingListSum","click","e","parent","clone","stopPropagation","UpdetaElementDrapList","prev","remove","elMainDrapList","elHeader","elFooter"],"mappings":"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","file":"script.js","sourcesContent":["(function () {\r\n    'use strict';\r\n\r\n    let byId = function (id) { return document.getElementById(id); },\r\n\r\n        loadScripts = function (desc, callback) {\r\n            let deps = [], key, idx = 0;\r\n\r\n            for (key in desc) {\r\n                deps.push(key);\r\n            }\r\n\r\n            (function _next() {\r\n                let pid,\r\n                    name = deps[idx],\r\n                    script = document.createElement('script');\r\n\r\n                script.type = 'text/javascript';\r\n                script.src = desc[deps[idx]];\r\n\r\n                pid = setInterval(function () {\r\n                    if (window[name]) {\r\n                        clearTimeout(pid);\r\n\r\n                        deps[idx++] = window[name];\r\n\r\n                        if (deps[idx]) {\r\n                            _next();\r\n                        } else {\r\n                            callback.apply(null, deps);\r\n                        }\r\n                    }\r\n                }, 30);\r\n\r\n                document.getElementsByTagName('head')[0].appendChild(script);\r\n            })()\r\n        },\r\n\r\n        console = window.console;\r\n\r\n\r\n    if (!console.log) {\r\n        console.log = function () {\r\n            alert([].join.apply(arguments, ' '));\r\n        };\r\n    }\r\n\r\n    /**\r\n     * 设置可拖动排序列表\r\n     */\r\n    (function () {\r\n        Sortable.create(byId('mainDarpList'), {\r\n            group: \"mainDarpList\",\r\n            animation: 150\r\n        });\r\n\r\n        Sortable.create(byId('drapSumList'), {\r\n            group: \"words\",\r\n            animation: 150,\r\n            onEnd: function(evt){\r\n                statistics()\r\n            }\r\n        });\r\n    })()\r\n\r\n\r\n\r\n    class DrapList {\r\n        constructor () {\r\n            /**\r\n             * 初始化获取元素和长度\r\n             * @type {jQuery|HTMLElement}\r\n             */\r\n            this.drapListElement= $('.drapList')\r\n            this.drapListElementLen= this.drapListElement.length\r\n\r\n            /**\r\n             * 设置多个列表可互相拖动方法\r\n             */\r\n            this.setDraplist(this.drapListElement, this.drapListElementLen)\r\n\r\n        }\r\n\r\n        /**\r\n         * 设置拖动列表\r\n         * @param drap\r\n         * @param len\r\n         */\r\n        setDraplist(drap, len) {\r\n            while (len--){\r\n                Sortable.create(drap[len], {\r\n                    group: \"words\",\r\n                    animation: 150,\r\n                    onEnd: function(evt){\r\n                        statistics()\r\n                    }\r\n                });\r\n\r\n            }\r\n        }\r\n\r\n        /**\r\n         * 更新拖动列表元素和长度\r\n         * @constructor\r\n         */\r\n        UpdetaElementDrapList(){\r\n            this.drapListElement = $('.drapList')\r\n            this.drapListElementLen =  this.drapListElement.length\r\n            this.setDraplist(this.drapListElement, this.drapListElementLen)\r\n        }\r\n    }\r\n    let draplist = new DrapList()\r\n\r\n\r\n    /**\r\n     * 统计行数\r\n     * @constructor\r\n     */\r\n    function statistics() {\r\n        $('.drapList').each(function () {\r\n            let element = $(this).children()\r\n            let len = element.length\r\n            if(len > 3 ){\r\n                toggleDrapFullMessage('#drapFullMessage', '一行最多放置三个，请添加新列或者放置下一列！', 1000 )\r\n                $('#drapSumList').append(element.last())\r\n                return false\r\n            }\r\n        })\r\n    }\r\n\r\n    /**\r\n     * 显示提示新信息\r\n     * @param obj\r\n     * @param val\r\n     * @param time\r\n     */\r\n    function toggleDrapFullMessage(obj, val, time) {\r\n        $(obj).text(val).fadeIn(function () {\r\n            setTimeout(function () {\r\n                $(obj).fadeOut()\r\n            }, time)\r\n        })\r\n    }\r\n\r\n    /**\r\n     * 输出所有 mainDarpList 列表选中的值\r\n     * @param el\r\n     * @returns {Array}\r\n     */\r\n    function sortingCheckedSum(el) {\r\n        let arr = []\r\n        $(el).each(function () {\r\n            if($(this).is(':checked')){\r\n                // console.log($(this).val())\r\n                arr.push($(this).val())\r\n            }\r\n        })\r\n        return arr\r\n    }\r\n\r\n    /**\r\n     * 输出所有 drapList 列表的值\r\n     * @param el\r\n     * @returns {Array}\r\n     */\r\n    function sortingListSum(el) {\r\n        let arr = []\r\n        $(el).each(function () {\r\n            arr.push($(this).text())\r\n        })\r\n        return arr\r\n    }\r\n\r\n\r\n    /**\r\n     * 添加新行\r\n     */\r\n    $('.addDrapList').each(function () {\r\n        $(this).click(function (e) {\r\n            let element = $(this).parent().parent().parent().children()\r\n            let len = element.length\r\n            if(len >= 3){\r\n                toggleDrapFullMessage('#drapFullMessage', '最多不能超过三行！', 1000 )\r\n                return false\r\n            } else {\r\n                $(this).parent().parent().parent().append($(\"#muban .drapContainer\").clone(true))\r\n            }\r\n            e.stopPropagation()\r\n            draplist.UpdetaElementDrapList()\r\n        })\r\n    })\r\n\r\n    /**\r\n     * 删除一行\r\n     */\r\n    $('.lessDrapList').each(function () {\r\n        $(this).click(function (e) {\r\n            let element = $(this).parent().prev().children()\r\n            let len = element.length\r\n            if(len){\r\n                $(element).each(function () {\r\n                    $('#drapSumList').append($(this))\r\n                })\r\n                $(this).parent().parent().remove()\r\n                return false\r\n            }else{\r\n                $(this).parent().parent().remove()\r\n            }\r\n            e.stopPropagation()\r\n            draplist.UpdetaElementDrapList()\r\n        })\r\n    })\r\n\r\n    /**\r\n     * 删除一个元素 插入到原始列表\r\n     */\r\n    $('.close').each(function () {\r\n        $(this).click(function (e) {\r\n            $('#drapSumList').append($(this).parent())\r\n            e.stopPropagation()\r\n        })\r\n    })\r\n\r\n\r\n    /**\r\n     * 测试结果\r\n     */\r\n    $('#test').click(function () {\r\n        let elMainDrapList = $('#mainDarpList li input[type=checkbox]')\r\n\r\n        let elHeader = $('#header .drapContainer .drapList li span')\r\n        let elFooter = $('#footer .drapContainer .drapList li span')\r\n        // let elSumList = $('#drapSumList li')\r\n\r\n        /**\r\n         * 返回结果\r\n         */\r\n        console.log(\r\n            /**\r\n             * 勾选结果\r\n             */\r\n            sortingCheckedSum(elMainDrapList),\r\n            /**\r\n             * 拖拽之后的结果\r\n             */\r\n            sortingListSum(elHeader),\r\n            sortingListSum(elFooter)\r\n        )\r\n    })\r\n\r\n})();\r\n\r\n\r\n\r\n"]}